{"ast":null,"code":"import{useContext,useState}from\"react\";import axios from\"axios\";import\"./update.scss\";import{usePosts}from\"../../context/PostsContext\";import{AuthContext}from\"../../context/authContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Update=_ref=>{let{setOpenUpdate}=_ref;const{user,updateUser}=usePosts();const{currentUser,setCurrentUser}=useContext(AuthContext);const[cover,setCover]=useState(null);const[profile,setProfile]=useState(null);const[texts,setTexts]=useState({email:user.email,password:user.password,name:user.name,city:user.city,website:user.website});const upload=async file=>{const formData=new FormData();formData.append(\"file\",file);try{const res=await axios.post(\"http://localhost:8000/api/upload\",formData,{headers:{\"Content-Type\":\"multipart/form-data\"},withCredentials:true});return res.data;}catch(err){console.log(err);}};const handleChange=e=>{setTexts(prev=>({...prev,[e.target.name]:e.target.value}));};const handleClick=async e=>{e.preventDefault();let coverUrl;let profileUrl;if(cover){coverUrl=await upload(cover);}else{coverUrl=user.coverPic;}if(profile){profileUrl=await upload(profile);}else{profileUrl=user.profilePic;}const updatedUser={...texts,coverPic:coverUrl,profilePic:profileUrl};setCurrentUser(updateUser);try{await updateUser(updatedUser);console.log(updateUser);setOpenUpdate(false);setCover(null);setProfile(null);}catch(error){console.error(\"Failed to update user\",error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"update\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Update Your Profile\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"files\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"cover\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Cover Picture\"}),/*#__PURE__*/_jsx(\"div\",{className:\"imgContainer\",children:/*#__PURE__*/_jsx(\"img\",{src:cover?URL.createObjectURL(cover):\"/upload/\"+user.coverPic,alt:\"\"})})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"cover\",style:{display:\"none\"},onChange:e=>setCover(e.target.files[0])}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"profile\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Profile Picture\"}),/*#__PURE__*/_jsx(\"div\",{className:\"imgContainer\",children:/*#__PURE__*/_jsx(\"img\",{src:profile?URL.createObjectURL(profile):\"/upload/\"+user.profilePic,alt:\"\"})})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"profile\",style:{display:\"none\"},onChange:e=>setProfile(e.target.files[0])})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:texts.email,name:\"email\",onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:texts.password,name:\"password\",onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:texts.name,name:\"name\",onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{children:\"Country / City\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"city\",value:texts.city,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{children:\"Website\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"website\",value:texts.website,onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,children:\"Update\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"close\",onClick:()=>setOpenUpdate(false),children:\"close\"})]})});};export default Update;","map":{"version":3,"names":["useContext","useState","axios","usePosts","AuthContext","jsx","_jsx","jsxs","_jsxs","Update","_ref","setOpenUpdate","user","updateUser","currentUser","setCurrentUser","cover","setCover","profile","setProfile","texts","setTexts","email","password","name","city","website","upload","file","formData","FormData","append","res","post","headers","withCredentials","data","err","console","log","handleChange","e","prev","target","value","handleClick","preventDefault","coverUrl","profileUrl","coverPic","profilePic","updatedUser","error","className","children","htmlFor","src","URL","createObjectURL","alt","type","id","style","display","onChange","files","onClick"],"sources":["C:/Users/zaina/OneDrive/Skrivbord/SocialPost-Project/client/src/components/update/Update.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./update.scss\";\r\nimport { usePosts } from \"../../context/PostsContext\";\r\nimport { AuthContext } from \"../../context/authContext\";\r\n\r\nconst Update = ({ setOpenUpdate }) => {\r\n  const { user, updateUser } = usePosts();\r\n  const { currentUser, setCurrentUser } = useContext(AuthContext);\r\n\r\n  const [cover, setCover] = useState(null);\r\n  const [profile, setProfile] = useState(null);\r\n  const [texts, setTexts] = useState({\r\n    email: user.email,\r\n    password: user.password,\r\n    name: user.name,\r\n    city: user.city,\r\n    website: user.website,\r\n  });\r\n\r\n  const upload = async (file) => {\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    try {\r\n      const res = await axios.post(\"http://localhost:8000/api/upload\", formData, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\"\r\n        },\r\n        withCredentials: true \r\n      });\r\n      return res.data;\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setTexts((prev) => ({ ...prev, [e.target.name]: e.target.value }));\r\n  };\r\n\r\n  const handleClick = async (e) => {\r\n    e.preventDefault();\r\n\r\n    let coverUrl;\r\n    let profileUrl;\r\n    if (cover) {\r\n      coverUrl = await upload(cover);\r\n    } else {\r\n      coverUrl = user.coverPic;\r\n    }\r\n\r\n    if (profile) {\r\n      profileUrl = await upload(profile);\r\n    } else {\r\n      profileUrl = user.profilePic;\r\n    }\r\n\r\n    const updatedUser = {\r\n      ...texts,\r\n      coverPic: coverUrl,\r\n      profilePic: profileUrl,\r\n    };\r\n    setCurrentUser(updateUser)\r\n\r\n    try {\r\n      await updateUser(updatedUser);\r\n      console.log(updateUser)\r\n\r\n      setOpenUpdate(false);\r\n      setCover(null);\r\n      setProfile(null);\r\n    } catch (error) {\r\n      console.error(\"Failed to update user\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"update\">\r\n      <div className=\"wrapper\">\r\n        <h1>Update Your Profile</h1>\r\n        <form>\r\n          <div className=\"files\">\r\n            <label htmlFor=\"cover\">\r\n              <span>Cover Picture</span>\r\n              <div className=\"imgContainer\">\r\n                <img\r\n                  src={cover ? URL.createObjectURL(cover) : \"/upload/\" + user.coverPic}\r\n                  alt=\"\"\r\n                />\r\n              </div>\r\n            </label>\r\n            <input\r\n              type=\"file\"\r\n              id=\"cover\"\r\n              style={{ display: \"none\" }}\r\n              onChange={(e) => setCover(e.target.files[0])}\r\n            />\r\n            <label htmlFor=\"profile\">\r\n              <span>Profile Picture</span>\r\n              <div className=\"imgContainer\">\r\n                <img\r\n                  src={profile ? URL.createObjectURL(profile) : \"/upload/\" + user.profilePic}\r\n                  alt=\"\"\r\n                />\r\n              </div>\r\n            </label>\r\n            <input\r\n              type=\"file\"\r\n              id=\"profile\"\r\n              style={{ display: \"none\" }}\r\n              onChange={(e) => setProfile(e.target.files[0])}\r\n            />\r\n          </div>\r\n          <label>Email</label>\r\n          <input\r\n            type=\"text\"\r\n            value={texts.email}\r\n            name=\"email\"\r\n            onChange={handleChange}\r\n          />\r\n          <label>Password</label>\r\n          <input\r\n            type=\"text\"\r\n            value={texts.password}\r\n            name=\"password\"\r\n            onChange={handleChange}\r\n          />\r\n          <label>Name</label>\r\n          <input\r\n            type=\"text\"\r\n            value={texts.name}\r\n            name=\"name\"\r\n            onChange={handleChange}\r\n          />\r\n          <label>Country / City</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"city\"\r\n            value={texts.city}\r\n            onChange={handleChange}\r\n          />\r\n          <label>Website</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"website\"\r\n            value={texts.website}\r\n            onChange={handleChange}\r\n          />\r\n          <button onClick={handleClick}>Update</button>\r\n        </form>\r\n        <button className=\"close\" onClick={() => setOpenUpdate(false)}>\r\n          close\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Update;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}